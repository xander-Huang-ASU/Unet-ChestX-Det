Sun Nov  2 19:00:47 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.95.05              Driver Version: 580.95.05      CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:01:00.0 Off |                   On |
| N/A   35C    P0             91W /  500W |    2811MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:41:00.0 Off |                   On |
| N/A   34C    P0             88W /  500W |    1771MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:81:00.0 Off |                   On |
| N/A   37C    P0             85W /  500W |     825MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:C1:00.0 Off |                   On |
| N/A   30C    P0             52W /  500W |     249MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |              Shared Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                Shared BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  2    5   0   0  |              71MiB / 19968MiB    | 28      0 |  2   0    1    0    0 |
|                  |               0MiB / 12271MiB    |           |                       |
+------------------+----------------------------------+-----------+-----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0    6    0            96593      C   vasp_std.nvhpc_cuda12_epyc             1338MiB |
|    0    3    0           145093      C   python                                  938MiB |
|    0    5    0          3972567      C   python                                  262MiB |
|    1    3    0           128154      C   python                                  280MiB |
|    1    5    0           140729      C   python                                  938MiB |
|    1    4    0           140730      C   python                                  280MiB |
+-----------------------------------------------------------------------------------------+
Torch CUDA: 11.8
Is CUDA available? True
GPU: NVIDIA A100-SXM4-80GB MIG 2g.20gb
=== Step 1: Generating Train Masks ===
âœ… Train masks already exist at: /scratch/yhuan591/chestX-Det/train_data/masks

=== Step 2: Generating Test Masks ===
âœ… Test masks already exist at: /scratch/yhuan591/chestX-Det/test_data/masks

=== Step 3: Training U-Net with Validation ===
ðŸš€ Using device: cuda
âœ… Epoch [1/30] - Train Loss: 0.5554 | Val Dice: 0.6139 | Val IoU: 0.4639
ðŸ’¾ Best model saved (Dice=0.6139)
âœ… Epoch [2/30] - Train Loss: 0.4264 | Val Dice: 0.6246 | Val IoU: 0.4716
ðŸ’¾ Best model saved (Dice=0.6246)
âœ… Epoch [3/30] - Train Loss: 0.3927 | Val Dice: 0.6141 | Val IoU: 0.4606
âœ… Epoch [4/30] - Train Loss: 0.4042 | Val Dice: 0.6346 | Val IoU: 0.4829
ðŸ’¾ Best model saved (Dice=0.6346)
âœ… Epoch [5/30] - Train Loss: 0.3595 | Val Dice: 0.6221 | Val IoU: 0.4713
âœ… Epoch [6/30] - Train Loss: 0.3378 | Val Dice: 0.6522 | Val IoU: 0.5037
ðŸ’¾ Best model saved (Dice=0.6522)
âœ… Epoch [7/30] - Train Loss: 0.3346 | Val Dice: 0.6468 | Val IoU: 0.5009
âœ… Epoch [8/30] - Train Loss: 0.3185 | Val Dice: 0.6678 | Val IoU: 0.5176
ðŸ’¾ Best model saved (Dice=0.6678)
âœ… Epoch [9/30] - Train Loss: 0.3122 | Val Dice: 0.6603 | Val IoU: 0.5134
âœ… Epoch [10/30] - Train Loss: 0.3156 | Val Dice: 0.6657 | Val IoU: 0.5190
âœ… Epoch [11/30] - Train Loss: 0.2806 | Val Dice: 0.6510 | Val IoU: 0.5030
âœ… Epoch [12/30] - Train Loss: 0.2806 | Val Dice: 0.6639 | Val IoU: 0.5199
âœ… Epoch [13/30] - Train Loss: 0.2544 | Val Dice: 0.6503 | Val IoU: 0.5021
âœ… Epoch [14/30] - Train Loss: 0.2609 | Val Dice: 0.6400 | Val IoU: 0.4938
âœ… Epoch [15/30] - Train Loss: 0.2374 | Val Dice: 0.6510 | Val IoU: 0.5066
âœ… Epoch [16/30] - Train Loss: 0.2378 | Val Dice: 0.6376 | Val IoU: 0.4885
âœ… Epoch [17/30] - Train Loss: 0.2306 | Val Dice: 0.6352 | Val IoU: 0.4899
âœ… Epoch [18/30] - Train Loss: 0.2336 | Val Dice: 0.6557 | Val IoU: 0.5066
âœ… Epoch [19/30] - Train Loss: 0.2295 | Val Dice: 0.6688 | Val IoU: 0.5227
ðŸ’¾ Best model saved (Dice=0.6688)
âœ… Epoch [20/30] - Train Loss: 0.2079 | Val Dice: 0.6657 | Val IoU: 0.5233
âœ… Epoch [21/30] - Train Loss: 0.2037 | Val Dice: 0.6172 | Val IoU: 0.4690
âœ… Epoch [22/30] - Train Loss: 0.1894 | Val Dice: 0.6641 | Val IoU: 0.5195
âœ… Epoch [23/30] - Train Loss: 0.2126 | Val Dice: 0.5766 | Val IoU: 0.4287
âœ… Epoch [24/30] - Train Loss: 0.2006 | Val Dice: 0.6454 | Val IoU: 0.5030
âœ… Epoch [25/30] - Train Loss: 0.1858 | Val Dice: 0.6432 | Val IoU: 0.5029
âœ… Epoch [26/30] - Train Loss: 0.1854 | Val Dice: 0.6377 | Val IoU: 0.4939
