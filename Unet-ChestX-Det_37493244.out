Sun Nov  2 18:05:30 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.95.05              Driver Version: 580.95.05      CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:01:00.0 Off |                   On |
| N/A   35C    P0             81W /  500W |    2811MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:41:00.0 Off |                   On |
| N/A   34C    P0             88W /  500W |    1771MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:81:00.0 Off |                   On |
| N/A   38C    P0             80W /  500W |     825MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:C1:00.0 Off |                   On |
| N/A   30C    P0             52W /  500W |     249MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |              Shared Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                Shared BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  2    5   0   0  |              71MiB / 19968MiB    | 28      0 |  2   0    1    0    0 |
|                  |               0MiB / 12271MiB    |           |                       |
+------------------+----------------------------------+-----------+-----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0    6    0            96593      C   vasp_std.nvhpc_cuda12_epyc             1338MiB |
|    0    3    0           145093      C   python                                  938MiB |
|    0    5    0          3972567      C   python                                  262MiB |
|    1    3    0           128154      C   python                                  280MiB |
|    1    5    0           140729      C   python                                  938MiB |
|    1    4    0           140730      C   python                                  280MiB |
+-----------------------------------------------------------------------------------------+
Torch CUDA: 11.8
Is CUDA available? True
GPU: NVIDIA A100-SXM4-80GB MIG 2g.20gb
=== Step 1: Generating Train Masks ===
‚úÖ Train masks already exist at: /scratch/yhuan591/chestX-Det/train_data/masks

=== Step 2: Generating Test Masks ===
‚úÖ Loaded 542 annotations from /scratch/yhuan591/chestX-Det/test.json

=== Summary ===
Total annotations: 542
‚úÖ Masks generated: 542
‚ö†Ô∏è Missing images: 0
‚ÑπÔ∏è  No-box (healthy) samples: 83
Masks saved to: /scratch/yhuan591/chestX-Det/test_data/masks


=== Step 3: Training U-Net with Validation ===
üöÄ Using device: cuda
‚úÖ Epoch [1/10] - Train Loss: 0.5331 | Val Dice: 0.6343 | Val IoU: 0.4835
üíæ Best model saved (Dice=0.6343)
‚úÖ Epoch [2/10] - Train Loss: 0.4235 | Val Dice: 0.5867 | Val IoU: 0.4394
‚úÖ Epoch [3/10] - Train Loss: 0.3908 | Val Dice: 0.6226 | Val IoU: 0.4733
‚úÖ Epoch [4/10] - Train Loss: 0.3769 | Val Dice: 0.5959 | Val IoU: 0.4409
‚úÖ Epoch [5/10] - Train Loss: 0.3601 | Val Dice: 0.6577 | Val IoU: 0.5098
üíæ Best model saved (Dice=0.6577)
‚úÖ Epoch [6/10] - Train Loss: 0.3524 | Val Dice: 0.6289 | Val IoU: 0.4756
‚úÖ Epoch [7/10] - Train Loss: 0.3455 | Val Dice: 0.6049 | Val IoU: 0.4545
‚úÖ Epoch [8/10] - Train Loss: 0.3386 | Val Dice: 0.6082 | Val IoU: 0.4633
‚úÖ Epoch [9/10] - Train Loss: 0.2963 | Val Dice: 0.6283 | Val IoU: 0.4816
‚úÖ Epoch [10/10] - Train Loss: 0.2973 | Val Dice: 0.6075 | Val IoU: 0.4623
üìä Training curves saved to training_curves.png
üî• Best Val Dice: 0.6577

üèÅ All steps completed successfully!
